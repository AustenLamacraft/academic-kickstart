---
# Documentation: https://wowchemy.com/docs/managing-content/
title: "Quantum Circuits II: Some Special Circuits"
subtitle: "ICTS lectures on Quantum Circuits"
summary: ""
authors: []
tags: []
categories: []
date: 2023-05-21T10:00:33Z
featured: false
draft: true
type: book
sidebar: false


# Featured image
# To use, add an image named `featured.jpg/png` to your page's folder.
# Focal points: Smart, Center, TopLeft, Top, TopRight, Left, Right, BottomLeft, Bottom, BottomRight.
image:
  caption: ""
  focal_point: ""
  preview_only: false

# Projects (optional).
#   Associate this post with one or more of your projects.
#   Simply enter your project's folder or file name without extension.
#   E.g. `projects = ["internal-project"]` references `content/project/deep-learning/index.md`.
#   Otherwise, set `projects = []`.
projects: []
toc: true  # Show table of contents? true/false
---

Here's my second lecture on quantum circuits.  

## Recap

In the first lecture we introduced quantum circuits as many-body dynamical systems and discussed some of the ways we can characterize their dynamics. We didn't obtain many concrete results, however, because general calculations — as in most quantum many-body systems — are intractable. In this lecture we'll study a number of different classes of circuit where analytic progress can be made. Naturally, these classes are all special in some way. We'll see that each has its own intrinsic interest other than its tractability.

## Random circuits

The first class are _random circuits_, which we met briefly last lecture when we studied a model with random exchange couplings. That model conserves all three components of the spin. Here, we'll consider gates chosen _uniformly_ from the unitaries acting on two qubits (this probability distribution is known as the [Haar measure](https://en.wikipedia.org/wiki/Haar_measure) on $U(4)$, the four dimensional unitary group). The motivations for this choice are:

TODO Actually we don't do this!!

1. Such circuits have no symmetries (in space, time, or in their internal structue) so the results we find should be _generic_ ("in some sense" as we theorists like to say).

2. (the real reason) By averaging over circuits we will see that the theoretical picture simplifies considerably, allowing for a tractable classical description.

In this lecture we'll choose the gates to be independent and identically distributed (iid). There are other possibilites. If we choose the gates random once and for all in the first two rows of the circuit, and then reuse the same gates subsequently, the result is a spatially disordered Floquet system.

### Dynamics of the averaged OTOC

In the last lecture we introduced the OTOC

$$
\operatorname{OTOC}_{jk}(t) \equiv \langle Z_j(t)Z_k(0)Z_j(t)Z_k(0)\rangle
$$

where $Z_j(t)=\mathcal{U}(t)Z_j\mathcal{U}^\dagger$ and $\mathcal{U}(t)$ is the unitary generated by the whole circuit. The OTOC can be extracted by appropriately contracting indices in $Z_j(t)\otimes Z_j(t)$, which we can think of an operator describing two copies of the system with identical dynamics. When we average over the random unitaries describing gates, only certain components of this operator survive. More precisely, since the averages are to be taken independently on each site, we identify invariants of the unitary group when it acts by conjugation (adjoint representation). The average OTOC dynamics then takes place in a space obtained by tensoring together these invariant subspaces for each site.

Since in the qubit case $SU(2)$ unitaries are identified (mod 2) with the rotations, this is equivalent to looking for _scalar_ operators made from the two copies. There are two:

$$
\begin{array}
\mathsf{1}\otimes\mathsf{1},\qquad \frac{1}{3}\left[X\otimes X+Y\otimes Y + Z\otimes Z\right].
\end{array}
$$

You can verify that when transformed by conjugating with $u\otimes u$ with $u\in SU(2)$ this are unaltered (though it's probably fairly obvious already).

Different papers prefer different bases. The most popular choice is in fact

$$
\begin{array}
\mathsf{1}\otimes\mathsf{1},\qquad \operatorname{SWAP}.
\end{array}
$$

(recall that $\operatorname{\mathsf{SWAP}}=\frac{1}{2}\left[X\otimes X+Y\otimes Y+Z\otimes Z + \mathsf{1}\otimes\mathsf{1}\right]$) This has the advantage of generalizing to multiple copies: the general set of invariants are the generalized SWAP operators corresponding to permutations of the copies (for two copies there are only two permutations)

Having identified the invariant local basis we now use it to expand the average of two copies of a time evolved operator

$$
\mathcal{O}^{(2)}(t)=\overline{O(t) \otimes O(t)} \equiv \overline{O(t)^{\otimes 2}}
$$

Denoting the two invariant operators as $\mathsf{O} \equiv\mathsf{1}\otimes\mathsf{1}$ and $\mathsf{1}\equiv\frac{1}{3}\left[X\otimes X + Y\otimes Y+ Z\otimes Z\right]$ we introduce the basis $\mathsf{S}_{1:N}\equiv\mathsf{S}_1\otimes \mathsf{S}_2\otimes\cdots \mathsf{S}_N$, with $\mathsf{S}_j=\mathsf{0},\mathsf{1}$ and expand

$$
\mathcal{O}^{(2)}(t) = \sum\_{\mathsf{S}\_{1:N}\in\{\mathsf{0},\mathsf{1}\}^N} P\_{\mathsf{S}\_{1:N}}\mathsf{S}\_{1:N}.
$$

TODO Discuss Kasia basis?

Next we need to find how the coefficients $P\_{\mathsf{S}\_{1:N}}$ are updated by a single gate (after averaging). A gate acting on sites $j$ and $j+1$ yields  

$$
\begin{equation}\label{eq:one-step}
U^\dagger_{j,j+1}\otimes U^\dagger_{j,j+1} \mathcal{O}^{(2)}(t+1)U_{j,j+1}\otimes U_{j,j+1}. 
\end{equation}
$$

We take $U_{j,j+1}$ to have the form

$$
U_{j,j+1} = V_{j,j+1} u_j \otimes u_{j+1}
$$

where $V_{j,j+1}$ is a fixed two qubit unitary and $u_j$ and $u_{j+1}$ are two single quibit unitaries that are chosen uniformly at random from $U(2)$, the two dimensional unitary group. After averaging all non-invariant components of $\eqref{eq:one-step}$ vanish and the invariant components don't depend on $u_j$ and $u_{j+1}$. We can then use the orthogonality of our invariant operators 

$$
\begin{align}
\tr\left[\mathsf{O}^2\right]=4\qquad  \tr\left[\mathsf{1}^2\right]=\frac{4}{3}\qquad 
\tr\left[\mathsf{O}\mathsf{1}\right]=0
\end{align}
$$

to extract the components of the evolved operator in the invariant basis. The result can be written as an update rule on the coefficients $P\_{\mathsf{S}\_{1:N}}$

$$
P\_{\mathsf{S}\_{1:N}}(t+1) = \sum\_{\mathsf{S}'\_j, \mathsf{S}'\_{j+1}}  P\_{\mathsf{S}\_1\cdots \mathsf{S}'\_j  \mathsf{S}'\_{j+1}\cdots \mathsf{S}\_N}(t)\Omega\_{\mathsf{S}'\_j \mathsf{S}'\_{j+1},\mathsf{S}\_j \mathsf{S}\_k}
$$

The precise form of the matrix $\Omega$ depends on the unitary $V_{j,j+1}$ that formed the "core" of the gate. We can however make a general statement about its form based on the conservation of the operator norm $\tr\left[O(t)^\dagger O(t)\right]$, whose average is

$$
\overline{\tr\left[O(t)^\dagger O(t)\right]} = 2\sum\_{\mathsf{S}\_{1:N}\in\{\mathsf{0},\mathsf{1}\}^N} P\_{\mathsf{S}\_{1:N}}.
$$

This tells us that whatever $\Omega$ is, its columns sum to one

$$
\sum_{S_j, S_{j+1}}\Omega\_{\mathsf{S}'\_j \mathsf{S}'\_{j+1},\mathsf{S}\_j \mathsf{S}\_k} = 1
$$

If the matrix elements are additionally nonnegative (which they are), we are dealing with a Markov process, with $\Omega$ playing the role of the transition matrix.

{{% callout note %}}

Why does Markov work? Include Kasia observation.

{{% /callout %}}

The supplementary material of [Google's OTOC experiment](https://www.science.org/doi/full/10.1126/science.abg5029?casa_token=TkmMj95XIYoAAAAA:NP67A_aYhL8lSDWtuG99i8oFfx1c79-Lz-UGKYsW1-bee3hQ7weJSxLLQwpPzfSEPvEqt6SPbB4UYA) contains a detailed derivation of the transition matrix relevant to the Sycamore gates 
$$
\begin{align}\label{eq:transition}
\Omega&=\left(\begin{array}{cccc}
1 & 0 & 0 & 0 \\\
0 & 1-a-b & a & b \\\
0 & a & 1-a-b & b \\\
0 & \frac{b}{3} & \frac{b}{3} & \left(1-\frac{2}{3} b\right)
\end{array}\right) \\\
a&=\frac{1}{3}\left(2 \sin ^{2} \theta+\sin ^{4} \theta\right) \qquad b=\frac{1}{3}\left(\frac{1}{2} \sin ^{2} 2 \theta+2\left(\sin ^{2} \theta+\cos ^{2} \theta\right)\right)
\end{align}
$$

with $\theta=\pi/2$ for $i\operatorname{SWAP}$ gate and $\theta=\pi/4$ for $\sqrt{i\operatorname{SWAP}}$.

Although the Google paper includes no earlier references at this point, the idea that unitary averages over two copies yields a Markov process on the invariant space has been rediscovered repeatedly in recent years. The first reference I'm aware of is [Oliveria, Dahlsten, and Plenio (2007)](https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.98.130502), which was concerned with the dynamics of the average purity. Recall that the purity is defined as $\gamma\equiv \tr \rho_A^2$, where $\rho_A$ is the reduced density matrix of a subsystem. The average purity can be extracted from the average of two copies of the density matrix $\rho(t)\otimes\rho(t)$. See [Rowlands and Lamacraft](https://journals.aps.org/prb/abstract/10.1103/PhysRevB.98.195125) for a related discussion of entanglement dynamics in noisy unitary evolution in continuous time. 

#### The Markov process

The transition matrix $\eqref{eq:transition}$ describes the possible transitions
  
$$\require{extpfeil} \Newextarrow{\xleftrightharpoon}{5,10}{0x21CB} 
\mathsf{10} \xleftrightharpoon[a]{a} \mathsf{01} \qquad \mathsf{11} \xleftrightharpoon[b/3]{b} \mathsf{10},\mathsf{01}
$$

Note that $\mathsf{0}$ is "inert": there are no transitions from or to $\mathsf{00}$. This makes sense, as $\mathsf{0}$ corresponds 

---

### Fredrickson–Andersen model

<div id="sketch-holder" align='center'>
</div>

- Stationary state: independent sites with $p_1=3/4$, $p_0=1/4$

---

### Butterfly velocity

- Front propagation characterised by finite velocity $v_\text{B}$

<p align="center">
<img src="assets/space-time-front.png" width="500">
</p>

---

### Front broadening

- Front broadens unless $v_\text{B}$ maximal as for $i\operatorname{SWAP}$



<figure align="center">
<img src="assets/google-otoc-front-swap.png" width="300">
<img src="assets/google-otoc-front-sqrt-swap.png" width="300">
<figcaption> $i\operatorname{SWAP}$ (left) vs. $\sqrt{i\operatorname{SWAP}}$ (right) </figcaption>
</figure>

---

-  _Diffusive_ in 1D $\propto \sqrt{t}$

-   KPZ dynamics in 2D

<p align="center">
<img src="assets/front-label.png" width="600">
</p>

 - See [Nahum, Vijay, and Haah](https://journals.aps.org/prx/abstract/10.1103/PhysRevX.8.021014) for much more

TODO: If we deal with the iSWAP class the front doesn't broaden and moves at the maximum possible speed. Hints at dual unitary 

---

### Classical simulation?

- Efficient simulation of averaged OTOC dynamics via Monte Carlo

- Appearance of Markov process a little surprising

---

### OTOC fluctuations

- Circuit-to-circuit fluctuations of OTOC from 

$$
\hat{\mathcal{O}}^{(4)}(t)=\overline{\hat{O}(t) \otimes \hat{O}(t) \otimes \hat{O}(t) \otimes \hat{O}(t)} \equiv \overline{\hat{O}(t)^{\otimes 4}}
$$

- Go through same procedure of identifying invariant states

- Evolution of average now involves _negative_ matrix elements

- Leads to [sign problem](https://en.wikipedia.org/wiki/Numerical_sign_problem) in Monte Carlo simulation

- Same problem for $\overline{\operatorname{OTOC}}$ in models with number conservation ([Rowlands and Lamacraft](https://journals.aps.org/prb/abstract/10.1103/PhysRevB.98.195125))



## Clifford circuits

No operator entanglment. Relation to cellular automata

Free fermion cases (see Sommers appendix for matchgate connection)

Note that SWAP is not matchgate (but iSWAP is)


## Dual unitary circuits

Discussion of some classes. General parameterization
Dual unitaries that are also Cliffords

Kicked Ising as particular example. Graphical proof of dual unitarity by Hadamard construction.

TODO Mention Free fermions / matchgates (see Josza paper)

The toy model is illustrative but of course rather special. It turns out that we find **exactly the same behavior of the reduced density matrix** (starting from certain special initial states) for a much larger class of unitary circuits built out of **dual unitary** gates. These obey an additional condition, corresponding to unitarity in the spatial direction 

<figure align="center">
<img src="assets/folded-dual-unitarity.png" width="60%">
<figcaption> Dual unitarity condition in the folded representation.</figcaption>
</figure>

The proof is actually a relatively simple matter of writing down the circuit and carefully applying the unitarity and dual unitarity conditions

TODO Add details of proof 

TODO Add discussion of Quantinuum paper [Holographic dynamics simulations with a trapped-ion quantum computer](https://www.nature.com/articles/s41567-022-01689-7)

TODO Gliders

TODO Extensions: random. higher dimensions. triunitary

### Entanglement membrane

Min cut

Easiest to do it here after we have seen it emerge in dual unitaries?

What does this imply about "line tension"?

### Maximal entanglement velocity implies dual unitarity


The property of dual unitarity is equivalent
to maximal operator entanglement (entanglement hierarchy paper)

See also recent paper on [AME states](https://arxiv.org/pdf/2212.06737.pdf)

Recently proved by [Zhou and Harrow (2022)](https://arxiv.org/abs/2204.10341).

Despite being subject to additional conditions, the family of dual unitary gates is quite large. $4\times 4$ unitaries are 16-dimensional, while the family of dual unitaries is 14-dimensional. The dual unitaries encompass some previously studied models, including the kicked Ising model at particular values of the couplings. From a methodological viewpoint dual unitary circuits are interesting in that they have enough structure to allow many calculations to be made, without being "integrable" in the usual sense.


TODO General intial conditions [Growth of entanglement of generic states under dual-unitary dynamics](https://journals.aps.org/prb/abstract/10.1103/PhysRevB.107.174311)

TODO Influence matrix / process tensor. Temporal entanglement

## Frontiers

### The effect of measurements

### Quantum supremacy


## Frontier: measurements

Up to now we've been exclusively concerned with quantum circuits made up of unitary gates. We all know that unitary evolution is not all there is to quantum mechanics, however: there's also the issue of *measurement*. How are the phenomena we've discussed so far – growth of entanglement, operator spreading, and so on – affected by measuring the system? For an extensive system probed over a long period of time, it's natural to imagine local measurements happening with a certain rate and a certain density in space. This problem has become incredibly popular with theorists since 2018, when two groups of authors ([Y Li, X Chen, MPA Fisher (2019)](https://journals.aps.org/prb/abstract/10.1103/PhysRevB.100.134306), [B Skinner, J Ruhman, A Nahum (2019)](https://journals.aps.org/prx/abstract/10.1103/PhysRevX.9.031009)) suggested that a circuit could undergo a phase transition in terms of the behavior of the above quantities as a function of measurement rate.

<figure align="center">
<img src="assets/measurement-circuit.png" width="70%"/>
<figcaption>
A unitary circuit interspersed with local projective measurements of the Pauli $Z$ operator (Source: Y Li, X Chen, MPA Fisher (2019))
</figcaption>
</figure>

While it's natural that measuring a system will reduce its quantum entanglement, perhaps the more surprising prediction was that extensive entanglement survives at a *finite* measurement rate, instead of being degraded to zero by repeated measurements. Roughly, this is because entanglement is continuously generated by the unitary dynamics of the circuit between measurements.

An alternative viewpoint appeared in [MJ Gullans and DA Huse (2020)](https://journals.aps.org/prx/abstract/10.1103/PhysRevX.10.041020). If the initial state of the system is mixed, it will be *purified* by (strong enough) measurements

<figure align="center">
<img src="assets/gullans-huse.png" width="70%"/>
<figcaption>
Phase diagram including the purification transition. Source: MJ Gullans and DA Huse (2020).
</figcaption>
</figure>

Note that all states of finite systems purify, but below the transition (low enough measurement rate) this will be on a timescale that is exponentially long in the system size.

Does that sound familiar? We encountered a very similar phenomenology in the dynamics of chaotic fronts in PCAs where there was some probability of non-injective rules. It seems to me that the merging of distinct trajectories in these classical systems is closely analogous to the purification transition in quantum systems. The same point of view was advanced recently in [Wilsher *et al.* (2022)](https://arxiv.org/abs/2203.11303). Whether there is more to this remains to be seen.


TODO Frontiers
   1. Measurement induced transitions
   2. Computational issues. [Computational power of one- and two-dimensional dual-unitary quantum circuits](https://quantum-journal.org/papers/q-2022-01-24-631/)
   3. Connections to cellular automata
   4. Codes. Code length (Sommers)
